{% extends "base_template.html.twig" %}

{% block content1 %}
<a href="javascript:history.back()" class="btn btn-primary mt-2 ms-2">Retour</a>

<div class="container my-4">
  <!-- Barre de navigation des onglets -->
  <div class="row mb-4">
    <div class="col text-center">
      <button id="btnFilms" class="btn btn-primary me-2">Films/Séries</button>
      <button id="btnForums" class="btn btn-primary me-2">Forums</button>
      <button id="btnUsers" class="btn btn-primary">Utilisateurs</button>
    </div>
  </div>

  <!-- Section Films/Séries -->
  <div class="row" id="sectionFilms">
    <h2 class="text-center my-4">Résultats Films/Séries pour : "{{ requete }}"</h2>
    {% if oas is not empty %}
      {% for oa in oas %}
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
          <div class="card h-100 shadow-sm">
            {% if oa.type == 'Film' %}
              <a href="index.php?controleur=oa&methode=afficherFilm&idOa={{ oa.idoa }}" class="text-decoration-none">
            {% else %}
              <a href="index.php?controleur=oa&methode=afficherSerie&idOa={{ oa.idoa }}" class="text-decoration-none">
            {% endif %}
                <img src="{{ oa.posterPath }}" class="card-img-top" alt="{{ oa.nom }}">
                <div class="card-body d-flex flex-column">
                  <h6 class="card-title text-center text-dark">{{ oa.nom }}</h6>
                </div>
              </a>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-center">Aucun film ou série trouvé.</p>
    {% endif %}
  </div>

  <!-- Section Forums -->
  <div class="row" id="sectionForums" style="display: none;">
    <h2 class="text-center my-4">Résultats Forums pour : "{{ requete }}"</h2>
    {% if forums is not empty %}
      {% for forum in forums %}
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
          <div class="card h-100 shadow-sm">
            <a href="index.php?controleur=forum&methode=afficherForum&id={{ forum.getIdForum }}" class="text-decoration-none">
              <div class="card-body d-flex flex-column">
                <h6 class="card-title text-center text-dark">{{ forum.getNom }}</h6>
                <p class="card-text text-center">{{ forum.getDescription }}</p>
              </div>
            </a>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-center">Aucun forum trouvé.</p>
    {% endif %}
  </div>

  <!-- Section Utilisateurs -->
  <div class="row" id="sectionUsersSearch" style="display: none;">
    <h2 class="text-center my-4">Résultats Utilisateurs pour : "{{ requete }}"</h2>
    {% if users is not empty %}
      {% for user in users %}
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
          <div class="card h-100 shadow-sm">
            <a href="index.php?controleur=utilisateur&methode=afficherProfil&id={{ user.getIdUtilisateur }}" class="text-decoration-none">
              <img src="{{ 'img/profils/' ~ user.getPhotoProfil }}" class="card-img-top" alt="{{ user.getPseudo }}">
              <div class="card-body d-flex flex-column">
                <h6 class="card-title text-center text-dark">{{ user.getPseudo }}</h6>
              </div>
            </a>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-center">Aucun utilisateur trouvé.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
{% block scripts %}
  {{ parent() }}
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const btnFilms = document.getElementById('btnFilms');
      const btnForums = document.getElementById('btnForums');
      const btnUsers = document.getElementById('btnUsers');
      const sectionFilms = document.getElementById('sectionFilms');
      const sectionForums = document.getElementById('sectionForums');
      const sectionUsersSearch = document.getElementById('sectionUsersSearch');

      // Par défaut, on affiche Films/Séries
      sectionFilms.style.display = 'flex';
      sectionForums.style.display = 'none';
      sectionUsersSearch.style.display = 'none';

      btnFilms.addEventListener('click', function () {
        sectionFilms.style.display = 'flex';
        sectionForums.style.display = 'none';
        sectionUsersSearch.style.display = 'none';
      });
      btnForums.addEventListener('click', function () {
        sectionFilms.style.display = 'none';
        sectionForums.style.display = 'flex';
        sectionUsersSearch.style.display = 'none';
      });
      btnUsers.addEventListener('click', function () {
        sectionFilms.style.display = 'none';
        sectionForums.style.display = 'none';
        sectionUsersSearch.style.display = 'flex';
      });
    });
  </script>
{% endblock %}
